<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/png" href="http://www.jeffreythompson.org/graphics/favicon.png">
    <title>Collision Detection</title>

    <!-- FONTS AND CSS -->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i|Raleway:400,600,800" rel="stylesheet">
    <link href="css/stylesheet.css" rel="stylesheet" />
    <link href="css/atom-light.css" rel="stylesheet" />
  </head>

  <body>
    <header>
      <div class="flex">
        <a href="line-circle.html" id="prev">&larr;</a>
        <span id="title">
            <a href="index.html">Collision Detection</a><br/>
            <a href="table_of_contents.html"><small>Table of Contents</small></a>
        </span>
        <a href="line-rect.html" id="next">&rarr;</a>
      </div>
    </header>

    <div id="sketch" hidden></div>

    <div id="wrapper">

      <main>
        <h1><a id="lineline" class="anchor" href="#lineline" aria-hidden="true" rel="nofollow"></a>LINE/LINE</h1>
<p>With this example, you'll be able to build a super-sweet sword fighting game! (Or reboot <a href="http://www.polygon.com/2014/9/19/6477103/neal-stephensons-kickstarter-clang-cancel" rel="nofollow">one that never got finished</a>?)</p>
<p>To check if two lines are touching, we have to calculate the distance to the point of intersection:</p>
<div class="highlight javascript"><pre class="editor editor-colors"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;uA&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span><span>(</span></span><span>x4</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>y1</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>-</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>y4</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>x1</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>/</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span><span>(</span></span><span>y4</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>x2</span><span class="keyword operator js"><span>-</span></span><span>x1</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>-</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>x4</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>y2</span><span class="keyword operator js"><span>-</span></span><span>y1</span><span class="meta brace round js"><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;uB&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span><span>(</span></span><span>x2</span><span class="keyword operator js"><span>-</span></span><span>x1</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>y1</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>-</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>y2</span><span class="keyword operator js"><span>-</span></span><span>y1</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>x1</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>/</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span><span>(</span></span><span>y4</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>x2</span><span class="keyword operator js"><span>-</span></span><span>x1</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>-</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>x4</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>y2</span><span class="keyword operator js"><span>-</span></span><span>y1</span><span class="meta brace round js"><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre></div>
<p>If there is a collision, <code>uA</code> and <code>uB</code> should both be in the range of 0-1. We test for that like this:</p>
<div class="highlight javascript"><pre class="editor editor-colors"><div class="line"><span class="source js"><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>uA&nbsp;</span><span class="keyword operator comparison js"><span>&gt;=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>0</span></span><span>&nbsp;</span><span class="keyword operator logical js"><span>&amp;&amp;</span></span><span>&nbsp;uA&nbsp;</span><span class="keyword operator comparison js"><span>&lt;=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>1</span></span><span>&nbsp;</span><span class="keyword operator logical js"><span>&amp;&amp;</span></span><span>&nbsp;uB&nbsp;</span><span class="keyword operator comparison js"><span>&gt;=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>0</span></span><span>&nbsp;</span><span class="keyword operator logical js"><span>&amp;&amp;</span></span><span>&nbsp;uB&nbsp;</span><span class="keyword operator comparison js"><span>&lt;=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>1</span></span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="constant language boolean false js"><span>false</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre></div>
<p>That's it! We can add one more feature, if desired, that will tell us the intersection point of the two lines. This might be useful if, for example, you're making a sword-fighting game and want <a href="http://tvtropes.org/pmwiki/pmwiki.php/Main/SwordSparks" rel="nofollow">sparks to fly where the two blades hit</a>.</p>
<div class="highlight javascript"><pre class="editor editor-colors"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;intersectionX&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;x1&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>uA&nbsp;</span><span class="keyword operator js"><span>*</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>x2</span><span class="keyword operator js"><span>-</span></span><span>x1</span><span class="meta brace round js"><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;intersectionY&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;y1&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>uA&nbsp;</span><span class="keyword operator js"><span>*</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>y2</span><span class="keyword operator js"><span>-</span></span><span>y1</span><span class="meta brace round js"><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre></div>
<p>Here's the full example:</p>
<div class="highlight javascript"><pre class="editor editor-colors"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;x1&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>0</span></span><span class="punctuation terminator statement js"><span>;</span></span><span>&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;line&nbsp;controlled&nbsp;by&nbsp;mouse</span></span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;y1&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>0</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;x2&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>10</span></span><span class="punctuation terminator statement js"><span>;</span></span><span>&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;fixed&nbsp;end</span></span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;y2&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>10</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;x3&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>100</span></span><span class="punctuation terminator statement js"><span>;</span></span><span>&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;static&nbsp;line</span></span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;y3&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>300</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;x4&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>500</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;y4&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>100</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="entity name function js"><span>setup</span></span><span class="meta parameters js"><span class="punctuation definition parameters begin bracket round js"><span>(</span></span><span class="punctuation definition parameters end bracket round js"><span>)</span></span></span></span><span>&nbsp;</span><span class="punctuation definition function body begin bracket curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;canvas&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>createCanvas</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span class="constant numeric decimal js"><span>600</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>400</span></span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>strokeWeight</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span class="constant numeric decimal js"><span>5</span></span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span><span>&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;make&nbsp;lines&nbsp;easier&nbsp;to&nbsp;see</span></span></span></div><div class="line"><span class="source js"><span class="punctuation definition function body end bracket curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="entity name function js"><span>draw</span></span><span class="meta parameters js"><span class="punctuation definition parameters begin bracket round js"><span>(</span></span><span class="punctuation definition parameters end bracket round js"><span>)</span></span></span></span><span>&nbsp;</span><span class="punctuation definition function body begin bracket curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>background</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span class="constant numeric decimal js"><span>255</span></span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;set&nbsp;line&#39;s&nbsp;end&nbsp;to&nbsp;mouse&nbsp;coordinates</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;x1&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;mouseX</span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;y1&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;mouseY</span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;check&nbsp;for&nbsp;collision</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;if&nbsp;hit,&nbsp;change&nbsp;color&nbsp;of&nbsp;line</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;hit&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>lineLine</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span>x1</span><span class="meta delimiter object comma js"><span>,</span></span><span>y1</span><span class="meta delimiter object comma js"><span>,</span></span><span>x2</span><span class="meta delimiter object comma js"><span>,</span></span><span>y2</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;x3</span><span class="meta delimiter object comma js"><span>,</span></span><span>y3</span><span class="meta delimiter object comma js"><span>,</span></span><span>x4</span><span class="meta delimiter object comma js"><span>,</span></span><span>y4</span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>hit</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>stroke</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span class="constant numeric decimal js"><span>255</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>150</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>0</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>150</span></span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>else</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>stroke</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span class="constant numeric decimal js"><span>0</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>150</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>255</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>150</span></span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>line</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span>x3</span><span class="meta delimiter object comma js"><span>,</span></span><span>y3</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;x4</span><span class="meta delimiter object comma js"><span>,</span></span><span>y4</span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;draw&nbsp;user-controlled&nbsp;line</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>stroke</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span class="constant numeric decimal js"><span>0</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>150</span></span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>line</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span>x1</span><span class="meta delimiter object comma js"><span>,</span></span><span>y1</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;x2</span><span class="meta delimiter object comma js"><span>,</span></span><span>y2</span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="punctuation definition function body end bracket curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;LINE/LINE</span></span></span></div><div class="line"><span class="source js"><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="entity name function js"><span>lineLine</span></span><span class="meta parameters js"><span class="punctuation definition parameters begin bracket round js"><span>(</span></span><span class="variable parameter function js"><span>x1</span></span><span class="meta delimiter object comma js"><span>,</span></span><span class="variable parameter function js"><span>y1</span></span><span class="meta delimiter object comma js"><span>,</span></span><span class="variable parameter function js"><span>x2</span></span><span class="meta delimiter object comma js"><span>,</span></span><span class="variable parameter function js"><span>y2</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>x3</span></span><span class="meta delimiter object comma js"><span>,</span></span><span class="variable parameter function js"><span>y3</span></span><span class="meta delimiter object comma js"><span>,</span></span><span class="variable parameter function js"><span>x4</span></span><span class="meta delimiter object comma js"><span>,</span></span><span class="variable parameter function js"><span>y4</span></span><span class="punctuation definition parameters end bracket round js"><span>)</span></span></span></span><span>&nbsp;</span><span class="punctuation definition function body begin bracket curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;calculate&nbsp;the&nbsp;distance&nbsp;to&nbsp;intersection&nbsp;point</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;uA&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span><span>(</span></span><span>x4</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>y1</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>-</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>y4</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>x1</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>/</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span><span>(</span></span><span>y4</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>x2</span><span class="keyword operator js"><span>-</span></span><span>x1</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>-</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>x4</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>y2</span><span class="keyword operator js"><span>-</span></span><span>y1</span><span class="meta brace round js"><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;uB&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span><span>(</span></span><span>x2</span><span class="keyword operator js"><span>-</span></span><span>x1</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>y1</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>-</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>y2</span><span class="keyword operator js"><span>-</span></span><span>y1</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>x1</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>/</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span><span>(</span></span><span>y4</span><span class="keyword operator js"><span>-</span></span><span>y3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>x2</span><span class="keyword operator js"><span>-</span></span><span>x1</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>-</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>x4</span><span class="keyword operator js"><span>-</span></span><span>x3</span><span class="meta brace round js"><span>)</span></span><span class="keyword operator js"><span>*</span></span><span class="meta brace round js"><span>(</span></span><span>y2</span><span class="keyword operator js"><span>-</span></span><span>y1</span><span class="meta brace round js"><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;if&nbsp;uA&nbsp;and&nbsp;uB&nbsp;are&nbsp;between&nbsp;0-1,&nbsp;lines&nbsp;are&nbsp;colliding</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>uA&nbsp;</span><span class="keyword operator comparison js"><span>&gt;=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>0</span></span><span>&nbsp;</span><span class="keyword operator logical js"><span>&amp;&amp;</span></span><span>&nbsp;uA&nbsp;</span><span class="keyword operator comparison js"><span>&lt;=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>1</span></span><span>&nbsp;</span><span class="keyword operator logical js"><span>&amp;&amp;</span></span><span>&nbsp;uB&nbsp;</span><span class="keyword operator comparison js"><span>&gt;=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>0</span></span><span>&nbsp;</span><span class="keyword operator logical js"><span>&amp;&amp;</span></span><span>&nbsp;uB&nbsp;</span><span class="keyword operator comparison js"><span>&lt;=</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>1</span></span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;optionally,&nbsp;draw&nbsp;a&nbsp;circle&nbsp;where&nbsp;the&nbsp;lines&nbsp;meet</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;intersectionX&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;x1&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>uA&nbsp;</span><span class="keyword operator js"><span>*</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>x2</span><span class="keyword operator js"><span>-</span></span><span>x1</span><span class="meta brace round js"><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;intersectionY&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;y1&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>uA&nbsp;</span><span class="keyword operator js"><span>*</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>y2</span><span class="keyword operator js"><span>-</span></span><span>y1</span><span class="meta brace round js"><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>fill</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span class="constant numeric decimal js"><span>255</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>0</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>0</span></span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>noStroke</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>ellipse</span></span><span class="meta arguments js"><span class="punctuation definition arguments begin bracket round js"><span>(</span></span><span>intersectionX</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;intersectionY</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>20</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>20</span></span><span class="punctuation definition arguments end bracket round js"><span>)</span></span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="constant language boolean false js"><span>false</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="punctuation definition function body end bracket curly js"><span>}</span></span></span></div></pre></div>
<p>Based on a tutorial by <a href="http://paulbourke.net/geometry/pointlineplane" rel="nofollow">Paul Bourke</a>, who includes code to test if the lines are parallel and <a href="http://mathworld.wolfram.com/CoincidentLines.html" rel="nofollow">coincident</a>. Also based on <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=geometry2" rel="nofollow">this post by Ibackstrom</a> and help from <a href="http://www.reddit.com/r/math/comments/36dt75/what_does_this_equation_solve_for/crd5mcc" rel="nofollow">Reddit</a>.</p>

      </main>

      <footer>
        <p>[ <a href="./index.html">intro</a>, <a href="https://github.com/crhallberg/CollisionDetection">source</a>, <a href="https://github.com/crhallberg/CollisionDetection/issues">issues</a> ]</p>

        <p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" style="width:80px; height:15px" /></a></a>
      </footer>
    </div>

    <!-- nice smart quotes, via: http://smartquotesjs.com -->
    <script src="js/smartquotes.min.js"></script>
    <!-- p5.js -->
    <script src="js/p5.min.js"></script>
    <script>var x1 = 0; // line controlled by mouse
var y1 = 0;
var x2 = 10; // fixed end
var y2 = 10;

var x3 = 100; // static line
var y3 = 300;
var x4 = 500;
var y4 = 100;

function setup() {
    var canvas = createCanvas(600, 400);
    canvas.parent('sketch');

    strokeWeight(5); // make lines easier to see
}

function draw() {
    background(255);

    // set line's end to mouse coordinates
    x1 = mouseX;
    y1 = mouseY;

    // check for collision
    // if hit, change color of line
    var hit = lineLine(x1,y1,x2,y2, x3,y3,x4,y4);
    if (hit) stroke(255, 150, 0, 150);
    else stroke(0, 150, 255, 150);
    line(x3,y3, x4,y4);

    // draw user-controlled line
    stroke(0, 150);
    line(x1,y1, x2,y2);
}

// LINE/LINE
function lineLine(x1,y1,x2,y2, x3,y3,x4,y4) {
    // calculate the distance to intersection point
    var uA = ((x4-x3)*(y1-y3) - (y4-y3)*(x1-x3)) / ((y4-y3)*(x2-x1) - (x4-x3)*(y2-y1));
    var uB = ((x2-x1)*(y1-y3) - (y2-y1)*(x1-x3)) / ((y4-y3)*(x2-x1) - (x4-x3)*(y2-y1));

    // if uA and uB are between 0-1, lines are colliding
    if (uA >= 0 && uA <= 1 && uB >= 0 && uB <= 1) {
        // optionally, draw a circle where the lines meet
        var intersectionX = x1 + (uA * (x2-x1));
        var intersectionY = y1 + (uA * (y2-y1));
        fill(255, 0, 0);
        noStroke();
        ellipse(intersectionX, intersectionY, 20, 20);

        return true;
    }
    return false;
}document.getElementById('sketch').removeAttribute('hidden');</script>
  </body>
</html>
